"0","alldates$category <- NA"
"0",""
"0","alldates.clean <- subset(alldates,alldates$infinite == FALSE & "
"0","                                  alldates$rejected == FALSE & "
"0","                                  alldates$human == FALSE)"
"0","collids.cat <- data.frame(collid = unique(alldates.clean$collectionunitid))"
"0","collids.cat$category <- NA"
"0","for (i in 1:length(collids.cat$collid)) {"
"0","  dd <- which(alldates.clean$collectionunitid == collids.cat$collid[i])"
"0","  if (any(alldates.clean[dd,]$agetypeid != ""Radiocarbon years BP"")) {"
"0","    if (any(alldates.clean[dd,]$agetypeid == ""Radiocarbon years BP"")) {"
"0","      collids.cat[i,""category""] <- 3 } else { collids.cat[i,""category""] <- 4 }"
"0","  } else {"
"0","    if (length(unique(alldates.clean[dd,]$analysisunitid)) == 1) {"
"0","      collids.cat[i,""category""] <- 1 } else { collids.cat[i,""category""] <- 2 }"
"0","  }"
"0","}"
"0","alldates$category <- collids.cat$category[match(alldates$collectionunitid,collids.cat$collid)]"
"0","alldates <- subset(alldates,alldates$category!=4)"
