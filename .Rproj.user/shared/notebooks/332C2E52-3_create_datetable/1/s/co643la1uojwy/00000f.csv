"0","if (exists(""geochronology.table"")) {if (checkRecent(geochronology.table) == F) {rm(geochronology.table)}}"
"0","if (!exists(""geochronology.table"")) {print(""Downloading table 'geochronology'..."")"
"0","  geochronology.table <- distinct(get_table(""geochronology"", limit = 99999999))}"
"1","[1]"
"1"," ""Downloading table 'geochronology'..."""
"1","
"
"0","#merge all together"
"0","a <- distinct(inner_join(subset(vert_and_chron,vert_and_chron$datasettype == ""geochron""),"
"0","                         distinct(samples.ids[,c(1,3)]),by = ""datasetid""))"
"0","b <- distinct(right_join(a, geochrons.ti, by = ""analysisunitid""))"
"0","c <- distinct(inner_join(b,data.frame(siteid = as.numeric(siteinfo$siteid),siteinfo = siteinfo$sitename),by = ""siteid""))"
"0","d <- distinct(inner_join(c, collections.ti, by = ""collectionunitid"")) ## ERROR this line is not working! collections.ti is a list, c is a data.frame"
"0","e <- distinct(left_join(d,distinct(geochronology.table[,c(""geochronid"",""sampleid"",""delta13c"")]),by=""geochronid""))"
"0",""
"0","geochrons.all <- e[,c(""siteid"", ""collectionunitid"", ""sampleid"", ""datasetid.x"", ""analysisunitid"", "
"0","                  ""geochronid"", ""geochrontype"", ""agetype"", ""age"", ""errorolder"", ""erroryounger"", "
"0","          ""infinite"", ""delta13c"", ""labnumber"", ""materialdated"", ""notes"", ""depenvtid"", ""siteinfo"")]"
"0","colnames(geochrons.all) <- c(""siteid"", ""collectionunitid"", ""sampleid"", ""datasetid"", ""analysisunitid"","
"0","                  ""geochronid"", ""geochrontypeid"", ""agetypeid"", ""age"", ""errorolder"", ""erroryounger"", "
"0","          ""infinite"", ""delta13c"", ""labnumber"", ""materialdated"", ""notes"", ""depenvtid"", ""sitename"")"
"0",""
"0","print(paste(nrow(geochrons.all), ""dates found before filtering by taxonomy and age"", collapse = "" ""))"
"1","[1]"
"1"," ""10701 dates found before filtering by taxonomy and age"""
"1","
"
"0","write.csv(geochrons.all, here(""data/dates_for_analysis_allvert.csv""), row.names = F)"
